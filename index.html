<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Ligue Warzone ‚Äî Classement & Calendrier</title>
  <meta name="description" content="Classement, journ√©es (Masters Kills) et calendrier de la Ligue Warzone."/>
  <style>
    :root{ --bg:#0f1115; --card:#151924; --muted:#8b98a5; --text:#e7edf3; --border:#202636; --bad:#ef4444; }
    *{box-sizing:border-box} html,body{height:100%}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif;background:#0b0f14;color:var(--text)}
    .wrap{max-width:1100px;margin:0 auto;padding:22px}
    header{display:flex;justify-content:space-between;gap:12px;align-items:center;margin-bottom:12px}
    .title h1{margin:0;font-size:22px}
    .title p{margin:4px 0 0;color:var(--muted);font-size:13px}
    .tabs{display:flex;gap:8px;flex-wrap:wrap}
    .tab{border:1px solid var(--border);background:#111622;color:#d8e7ff;border-radius:10px;padding:8px 12px;cursor:pointer}
    .tab.active,.tab:hover{outline:2px solid rgba(109,211,255,.25)}
    .card{background:#121826;border:1px solid var(--border);border-radius:16px;padding:16px;margin-top:14px}
    .toolbar{display:flex;gap:8px;flex-wrap:wrap;align-items:center;margin-bottom:10px}
    .pill{display:inline-block;padding:6px 10px;border:1px solid var(--border);border-radius:999px;background:#0f1421;color:#cfe6ff}
    .btn{cursor:pointer;padding:6px 10px;border:1px solid var(--border);border-radius:10px;background:#141b24;color:#e8eef5}
    .input{background:#0c0f16;border:1px solid var(--border);padding:8px 10px;border-radius:10px;color:var(--text)}
    table{width:100%;border-collapse:separate;border-spacing:0 10px}
    th,td{padding:10px;text-align:left}
    th{color:#b9c6d1;font-size:12px;letter-spacing:.5px;text-transform:uppercase}
    tbody tr{background:#0f1421;border:1px solid var(--border)}
    tbody tr td:first-child{border-top-left-radius:12px;border-bottom-left-radius:12px}
    tbody tr td:last-child{border-top-right-radius:12px;border-bottom-right-radius:12px}
    .rank{width:36px;text-align:center;font-weight:800}
    .badge{width:28px;height:28px;border-radius:50%;display:grid;place-items:center;background:#233042;color:#e7edf3;font-weight:800}
    /* calendrier */
    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:12px}
    .event{border:1px solid var(--border);background:#0f1421;border-radius:14px;padding:12px}
    .event.played .title{ text-decoration: line-through; text-decoration-color: var(--bad); text-decoration-thickness: 2px; color:var(--bad) }
    .muted{color:var(--muted)}
  </style>
</head>
<body>
<div class="wrap">
  <header>
    <div class="title">
      <h1>Ligue Warzone</h1>
      <p>Classement, journ√©es & calendrier</p>
    </div>
    <nav class="tabs" role="tablist" aria-label="Navigation">
      <button class="tab active" data-tab="standings">Classement</button>
      <button class="tab" data-tab="calendar">Calendrier</button>
    </nav>
  </header>

  <!-- CLASSEMENT -->
  <section id="standings" class="card" role="tabpanel">
    <div class="toolbar">
      <input id="search" class="input" placeholder="Rechercher un joueur‚Ä¶" />
      <span id="season" class="pill">Saison ‚Äî</span>
      <span id="updated" class="pill">Derni√®re mise √† jour ‚Äî</span>
    </div>
    <table aria-label="Classement">
      <thead>
        <tr><th>#</th><th>Joueur</th><th>MJ</th><th>Kills</th><th>Bonus</th><th>Pts</th></tr>
      </thead>
      <tbody id="tbody"></tbody>
    </table>
  </section>

  <!-- CALENDRIER -->
  <section id="calendar" class="card" role="tabpanel" hidden>
    <div class="toolbar">
      <button id="togglePlayed" class="btn">Basculer ‚Äújou√©e‚Äù (saisie rapide)</button>
    </div>
    <div id="calwrap" class="grid"></div>
    <p class="muted" style="margin-top:8px">Les journ√©es <strong>jou√©es</strong> sont <span style="color:#ef4444">rouges</span> et <span style="text-decoration:line-through;color:#ef4444">barr√©es</span>.</p>
  </section>
</div>

<script>
/* ---------- SOURCES DE DONN√âES ---------- */
const STANDINGS_URL = "./warzone.json";
const CALENDAR_URL  = "./calendar_warzone.json";

/* ---------- UTILS ---------- */
const asInt = v => Number.parseInt(v,10) || 0;
const byId  = id => document.getElementById(id);
const fmt   = iso => { const d=new Date(iso); return isNaN(d)? "‚Äî" : d.toLocaleString('fr-FR',{dateStyle:'medium', timeStyle:'short'}) };

/* ---------- √âTAT ---------- */
let state = { season: 1, updatedAt: new Date().toISOString(), players: [], journees: [], calendar: [] };

/* ---------- CLASSEMENT (Pts = kills + bonus) ---------- */
function computeStandings(){
  const table = new Map(
    (state.players || []).map(p => [
      p.id,
      { id:p.id, name:p.name, color:p.color||'#233042', MJ:0, KILLS:0, BONUS:0, PTS:0 }
    ])
  );
  const bonusMap = {1:60,2:40,3:20,4:10};
  for (const j of (state.journees || [])) {
    for (const e of (j.entries || [])) {
      const row = table.get(e.player);
      if (!row) continue;
      row.MJ += 1;
      const kills = asInt(e.kills);
      const bonus = Number.isFinite(Number(e.bonus))
        ? asInt(e.bonus)
        : (bonusMap[asInt(e.rank)] || 0);
      const pts = kills + bonus; // r√®gle fix√©e
      row.KILLS += kills; row.BONUS += bonus; row.PTS += pts;
    }<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ligue Warzone ‚Äì Classement & Journ√©es</title>
  <meta name="description" content="Site gratuit et simple pour pr√©senter une ligue Warzone : classement, journ√©es (Masters Kills), joueurs et r√®glement." />
  <style>
    :root{ --bg:#0f1115; --card:#151924; --muted:#8b98a5; --text:#e7edf3; --accent:#6dd3ff; --accent2:#9b8cff; --ok:#36d399; --warn:#fbbf24; --bad:#ef4444; --border:#202636; }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Inter,Helvetica,Arial,sans-serif;background:linear-gradient(180deg,#0e1014 0%,#0f1115 40%,#0a0c10 100%);color:var(--text);}    
    a{color:var(--accent)}
    .wrap{max-width:1100px;margin:0 auto;padding:24px}
    header{display:flex;gap:16px;align-items:center;justify-content:space-between;margin-bottom:16px}
    .brand{display:flex;gap:12px;align-items:center}
    .logo{width:40px;height:40px;border-radius:12px;background:conic-gradient(from 140deg at 50% 50%,var(--accent),var(--accent2));display:grid;place-items:center;font-weight:800;color:#0a0c10}
    .title h1{font-size:24px;margin:0}
    .title p{margin:2px 0 0;color:var(--muted);font-size:13px}

    .tabs{display:flex;gap:8px;flex-wrap:wrap}
    .tab{background:var(--card);border:1px solid var(--border);padding:10px 14px;border-radius:12px;cursor:pointer;font-weight:600;color:#cfe6ff;opacity:.85}
    .tab.active,.tab:hover{outline:2px solid rgba(109,211,255,.25);opacity:1}

    .cards{display:grid;grid-template-columns:repeat(12,1fr);gap:14px;margin-top:16px}
    .card{grid-column:span 12;background:var(--card);border:1px solid var(--border);border-radius:16px;padding:16px}
    @media(min-width:800px){.card.half{grid-column:span 6}}

    .toolbar{display:flex;gap:8px;flex-wrap:wrap;align-items:center;margin-bottom:10px}
    .input{background:#0c0f16;border:1px solid var(--border);padding:8px 10px;border-radius:10px;color:var(--text)}
    .pill{display:inline-block;padding:6px 10px;border:1px solid var(--border);border-radius:999px;background:#0f1421;color:#cfe6ff}

    /* Classement */
    table{width:100%;border-collapse:separate;border-spacing:0 10px}
    th,td{text-align:left;padding:10px}
    th{color:#b9c6d1;font-size:12px;letter-spacing:.6px;text-transform:uppercase}
    tbody tr{background:#121826;border:1px solid var(--border)}
    tbody tr td:first-child{border-top-left-radius:12px;border-bottom-left-radius:12px}
    tbody tr td:last-child{border-top-right-radius:12px;border-bottom-right-radius:12px}
    .rank{width:38px;text-align:center;font-weight:800}
    .team{display:flex;align-items:center;gap:10px}
    .badge{width:28px;height:28px;border-radius:50%;display:grid;place-items:center;font-weight:800;color:#0a0c10}

    /* Calendar */
    .played{ text-decoration: line-through; color: var(--bad); opacity:.9 }
    .eventcard{border:1px solid var(--border);background:#0f1421;border-radius:14px;padding:12px;display:flex;justify-content:space-between;align-items:center}
    .eventmeta{color:var(--muted);font-size:12px}

    footer{margin:22px 0;color:var(--muted);font-size:12px}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="brand">
        <div class="logo">WZ</div>
        <div class="title">
          <h1>Ligue Warzone</h1>
          <p>Classement, journ√©es (Masters Kills), joueurs & r√®glement</p>
        </div>
      </div>
      <nav class="tabs" role="tablist" aria-label="Navigation principale">
        <button class="tab active" data-tab="standings">Classement</button>
        <button class="tab" data-tab="fixtures">Journ√©es</button>
        <button class="tab" data-tab="calendar">Calendrier</button>
        <button class="tab" data-tab="players">Joueurs</button>
        <button class="tab" data-tab="rules">R√®glement</button>
      </nav>
    </header>

    <!-- CLASSEMENT -->
    <section class="card" id="standings" role="tabpanel">
      <div class="toolbar">
        <input id="searchTeam" class="input" placeholder="Rechercher un joueur‚Ä¶" />
        <span class="pill" id="seasonLabel">Saison 1</span>
        <span class="pill" id="lastUpdate">Derni√®re mise √† jour ‚Äî ‚Äî</span>
      </div>
      <table aria-label="Tableau du classement">
        <thead>
          <tr>
            <th>#</th>
            <th>Joueur</th>
            <th>MJ</th>
            <th>Kills</th>
            <th>Bonus</th>
            <th>Pts</th>
          </tr>
        </thead>
        <tbody id="standingsBody"></tbody>
      </table>
    </section>

    <!-- JOURN√âES -->
    <section class="card half" id="fixtures" role="tabpanel" hidden>
      <div id="journeesList"></div>
    </section>

    <!-- CALENDRIER -->
    <section class="card" id="calendar" role="tabpanel" hidden>
      <div id="calendarWrap" class="grid"></div>
    </section>

    <!-- JOUEURS -->
    <section class="card half" id="players" role="tabpanel" hidden>
      <div class="grid" id="playersGrid"></div>
    </section>

    <!-- R√àGLEMENT -->
    <section class="card" id="rules" role="tabpanel" hidden>
      <h3>R√®glement ‚Äì synth√®se (adapt√© Warzone)</h3>
      <ol>
        <li><strong>Participants.</strong> 15 joueurs. √Ä chaque journ√©e : 3 matchs de 4 joueurs; 3 exempt√©s; 5 manches.</li>
        <li><strong>Affichage.</strong> MJ = journ√©es jou√©es, Kills = cumul r√©el, Bonus = cumul r√©el, <strong>Pts = somme des points officiels</strong> fournis par journ√©e.</li>
      </ol>
    </section>

    <footer class="wrap">Fait pour vous üíô ‚Äî h√©berg√© sur GitHub Pages</footer>
  </div>

  <script>
    const DATA_URL = "./warzone.json";
    const TO_INT = v => Number.parseInt(v,10) || 0;
    const TO_NUM = v => Number.isFinite(Number(v)) ? Number(v) : 0;

    // PTS = somme des "points" officiels; MJ/KILLS/BONUS = cumuls r√©els
    function computeStandings(state){
      const table = new Map(
        (state.players || []).map(p => [
          p.id,
          { id:p.id, name:p.name, color:p.color||'#233042', MJ:0, KILLS:0, BONUS:0, PTS:0 }
        ])
      );
      for (const j of (state.journees||[])) {
        for (const e of (j.entries||[])) {
          const row = table.get(e.player);
          if (!row) continue;
          row.MJ    += 1;
          row.KILLS += TO_INT(e.kills);
          row.BONUS += TO_INT(e.bonus);
          row.PTS   += TO_NUM(e.points); // ‚Üê on prend les points officiels
        }
      }
      return Array.from(table.values())
        .sort((a,b)=> (b.PTS-a.PTS)||(b.KILLS-a.KILLS)||(b.BONUS-a.BONUS)||a.name.localeCompare(b.name));
    }

    function renderStandings(state){
      const q = (document.getElementById('searchTeam').value||'').toLowerCase();
      const rows = computeStandings(state).filter(r=>r.name.toLowerCase().includes(q));
      const body = document.getElementById('standingsBody');
      body.innerHTML = rows.map((r,i)=>`
        <tr>
          <td class="rank">${i+1}</td>
          <td><div class="team"><div class="badge" style="background:${r.color}">${r.id}</div><strong>${r.name}</strong></div></td>
          <td>${r.MJ}</td><td>${r.KILLS}</td><td>${r.BONUS}</td><td><strong>${r.PTS}</strong></td>
        </tr>
      `).join('');
      document.getElementById('seasonLabel').textContent = "Saison " + (state.season||1);
      document.getElementById('lastUpdate').textContent = "Derni√®re mise √† jour ‚Äî " + new Date().toLocaleString('fr-FR');
    }

    async function boot(){
      try{
        const res = await fetch(DATA_URL,{cache:'no-store'});
        const data = await res.json();

        const state = {
          season:   data.season || 1,
          players:  data.players || [],
          // ‚ö†Ô∏è On filtre ici au cas o√π le JSON contiendrait encore des entr√©es MOU/FLO
          journees: (data.journees||[]).map(j => ({
            ...j,
            entries: (j.entries||[]).filter(e => e.player !== 'MOU' && e.player !== 'FLO')
          }))
        };

        renderStandings(state);
        const search = document.getElementById('searchTeam');
        if (search) search.addEventListener('input', ()=>renderStandings(state));
      }catch(e){ console.error("Erreur de chargement", e); }
    }
    boot();

    // Navigation onglets (inchang√©e)
    document.querySelectorAll('.tab').forEach(btn=>{
      btn.addEventListener('click',()=>{
        document.querySelectorAll('.tab').forEach(b=>b.classList.remove('active'));
        btn.classList.add('active');
        const id = btn.getAttribute('data-tab');
        document.querySelectorAll('section[role="tabpanel"]').forEach(s=>s.hidden=(s.id!==id));
      });
    });
  </script>
</body>
</html>

